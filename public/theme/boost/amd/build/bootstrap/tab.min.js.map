{"version":3,"file":"tab.min.js","sources":["../../src/bootstrap/tab.js"],"sourcesContent":["/**\r\n * --------------------------------------------------------------------------\r\n * Bootstrap tab.js\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\r\n * --------------------------------------------------------------------------\r\n */\r\n\r\nimport BaseComponent from './base-component'\r\nimport EventHandler from './dom/event-handler'\r\nimport SelectorEngine from './dom/selector-engine'\r\nimport { defineJQueryPlugin, getNextActiveElement, isDisabled } from './util/index'\r\n\r\n/**\r\n * Constants\r\n */\r\n\r\nconst NAME = 'tab'\r\nconst DATA_KEY = 'bs.tab'\r\nconst EVENT_KEY = `.${DATA_KEY}`\r\n\r\nconst EVENT_HIDE = `hide${EVENT_KEY}`\r\nconst EVENT_HIDDEN = `hidden${EVENT_KEY}`\r\nconst EVENT_SHOW = `show${EVENT_KEY}`\r\nconst EVENT_SHOWN = `shown${EVENT_KEY}`\r\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}`\r\nconst EVENT_KEYDOWN = `keydown${EVENT_KEY}`\r\nconst EVENT_LOAD_DATA_API = `load${EVENT_KEY}`\r\n\r\nconst ARROW_LEFT_KEY = 'ArrowLeft'\r\nconst ARROW_RIGHT_KEY = 'ArrowRight'\r\nconst ARROW_UP_KEY = 'ArrowUp'\r\nconst ARROW_DOWN_KEY = 'ArrowDown'\r\nconst HOME_KEY = 'Home'\r\nconst END_KEY = 'End'\r\n\r\nconst CLASS_NAME_ACTIVE = 'active'\r\nconst CLASS_NAME_FADE = 'fade'\r\nconst CLASS_NAME_SHOW = 'show'\r\nconst CLASS_DROPDOWN = 'dropdown'\r\n\r\nconst SELECTOR_DROPDOWN_TOGGLE = '.dropdown-toggle'\r\nconst SELECTOR_DROPDOWN_MENU = '.dropdown-menu'\r\nconst NOT_SELECTOR_DROPDOWN_TOGGLE = `:not(${SELECTOR_DROPDOWN_TOGGLE})`\r\n\r\nconst SELECTOR_TAB_PANEL = '.list-group, .nav, [role=\"tablist\"]'\r\nconst SELECTOR_OUTER = '.nav-item, .list-group-item'\r\nconst SELECTOR_INNER = `.nav-link${NOT_SELECTOR_DROPDOWN_TOGGLE}, .list-group-item${NOT_SELECTOR_DROPDOWN_TOGGLE}, [role=\"tab\"]${NOT_SELECTOR_DROPDOWN_TOGGLE}`\r\nconst SELECTOR_DATA_TOGGLE = '[data-bs-toggle=\"tab\"], [data-bs-toggle=\"pill\"], [data-bs-toggle=\"list\"]' // TODO: could only be `tab` in v6\r\nconst SELECTOR_INNER_ELEM = `${SELECTOR_INNER}, ${SELECTOR_DATA_TOGGLE}`\r\n\r\nconst SELECTOR_DATA_TOGGLE_ACTIVE = `.${CLASS_NAME_ACTIVE}[data-bs-toggle=\"tab\"], .${CLASS_NAME_ACTIVE}[data-bs-toggle=\"pill\"], .${CLASS_NAME_ACTIVE}[data-bs-toggle=\"list\"]`\r\n\r\n/**\r\n * Class definition\r\n */\r\n\r\nclass Tab extends BaseComponent {\r\n  constructor(element) {\r\n    super(element)\r\n    this._parent = this._element.closest(SELECTOR_TAB_PANEL)\r\n\r\n    if (!this._parent) {\r\n      return\r\n      // TODO: should throw exception in v6\r\n      // throw new TypeError(`${element.outerHTML} has not a valid parent ${SELECTOR_INNER_ELEM}`)\r\n    }\r\n\r\n    // Set up initial aria attributes\r\n    this._setInitialAttributes(this._parent, this._getChildren())\r\n\r\n    EventHandler.on(this._element, EVENT_KEYDOWN, event => this._keydown(event))\r\n  }\r\n\r\n  // Getters\r\n  static get NAME() {\r\n    return NAME\r\n  }\r\n\r\n  // Public\r\n  show() { // Shows this elem and deactivate the active sibling if exists\r\n    const innerElem = this._element\r\n    if (this._elemIsActive(innerElem)) {\r\n      return\r\n    }\r\n\r\n    // Search for active tab on same parent to deactivate it\r\n    const active = this._getActiveElem()\r\n\r\n    const hideEvent = active ?\r\n      EventHandler.trigger(active, EVENT_HIDE, { relatedTarget: innerElem }) :\r\n      null\r\n\r\n    const showEvent = EventHandler.trigger(innerElem, EVENT_SHOW, { relatedTarget: active })\r\n\r\n    if (showEvent.defaultPrevented || (hideEvent && hideEvent.defaultPrevented)) {\r\n      return\r\n    }\r\n\r\n    this._deactivate(active, innerElem)\r\n    this._activate(innerElem, active)\r\n  }\r\n\r\n  // Private\r\n  _activate(element, relatedElem) {\r\n    if (!element) {\r\n      return\r\n    }\r\n\r\n    element.classList.add(CLASS_NAME_ACTIVE)\r\n\r\n    this._activate(SelectorEngine.getElementFromSelector(element)) // Search and activate/show the proper section\r\n\r\n    const complete = () => {\r\n      if (element.getAttribute('role') !== 'tab') {\r\n        element.classList.add(CLASS_NAME_SHOW)\r\n        return\r\n      }\r\n\r\n      element.removeAttribute('tabindex')\r\n      element.setAttribute('aria-selected', true)\r\n      this._toggleDropDown(element, true)\r\n      EventHandler.trigger(element, EVENT_SHOWN, {\r\n        relatedTarget: relatedElem\r\n      })\r\n    }\r\n\r\n    this._queueCallback(complete, element, element.classList.contains(CLASS_NAME_FADE))\r\n  }\r\n\r\n  _deactivate(element, relatedElem) {\r\n    if (!element) {\r\n      return\r\n    }\r\n\r\n    element.classList.remove(CLASS_NAME_ACTIVE)\r\n    element.blur()\r\n\r\n    this._deactivate(SelectorEngine.getElementFromSelector(element)) // Search and deactivate the shown section too\r\n\r\n    const complete = () => {\r\n      if (element.getAttribute('role') !== 'tab') {\r\n        element.classList.remove(CLASS_NAME_SHOW)\r\n        return\r\n      }\r\n\r\n      element.setAttribute('aria-selected', false)\r\n      element.setAttribute('tabindex', '-1')\r\n      this._toggleDropDown(element, false)\r\n      EventHandler.trigger(element, EVENT_HIDDEN, { relatedTarget: relatedElem })\r\n    }\r\n\r\n    this._queueCallback(complete, element, element.classList.contains(CLASS_NAME_FADE))\r\n  }\r\n\r\n  _keydown(event) {\r\n    if (!([ARROW_LEFT_KEY, ARROW_RIGHT_KEY, ARROW_UP_KEY, ARROW_DOWN_KEY, HOME_KEY, END_KEY].includes(event.key))) {\r\n      return\r\n    }\r\n\r\n    event.stopPropagation()// stopPropagation/preventDefault both added to support up/down keys without scrolling the page\r\n    event.preventDefault()\r\n\r\n    const children = this._getChildren().filter(element => !isDisabled(element))\r\n    let nextActiveElement\r\n\r\n    if ([HOME_KEY, END_KEY].includes(event.key)) {\r\n      nextActiveElement = children[event.key === HOME_KEY ? 0 : children.length - 1]\r\n    } else {\r\n      const isNext = [ARROW_RIGHT_KEY, ARROW_DOWN_KEY].includes(event.key)\r\n      nextActiveElement = getNextActiveElement(children, event.target, isNext, true)\r\n    }\r\n\r\n    if (nextActiveElement) {\r\n      nextActiveElement.focus({ preventScroll: true })\r\n      Tab.getOrCreateInstance(nextActiveElement).show()\r\n    }\r\n  }\r\n\r\n  _getChildren() { // collection of inner elements\r\n    return SelectorEngine.find(SELECTOR_INNER_ELEM, this._parent)\r\n  }\r\n\r\n  _getActiveElem() {\r\n    return this._getChildren().find(child => this._elemIsActive(child)) || null\r\n  }\r\n\r\n  _setInitialAttributes(parent, children) {\r\n    this._setAttributeIfNotExists(parent, 'role', 'tablist')\r\n\r\n    for (const child of children) {\r\n      this._setInitialAttributesOnChild(child)\r\n    }\r\n  }\r\n\r\n  _setInitialAttributesOnChild(child) {\r\n    child = this._getInnerElement(child)\r\n    const isActive = this._elemIsActive(child)\r\n    const outerElem = this._getOuterElement(child)\r\n    child.setAttribute('aria-selected', isActive)\r\n\r\n    if (outerElem !== child) {\r\n      this._setAttributeIfNotExists(outerElem, 'role', 'presentation')\r\n    }\r\n\r\n    if (!isActive) {\r\n      child.setAttribute('tabindex', '-1')\r\n    }\r\n\r\n    this._setAttributeIfNotExists(child, 'role', 'tab')\r\n\r\n    // set attributes to the related panel too\r\n    this._setInitialAttributesOnTargetPanel(child)\r\n  }\r\n\r\n  _setInitialAttributesOnTargetPanel(child) {\r\n    const target = SelectorEngine.getElementFromSelector(child)\r\n\r\n    if (!target) {\r\n      return\r\n    }\r\n\r\n    this._setAttributeIfNotExists(target, 'role', 'tabpanel')\r\n\r\n    if (child.id) {\r\n      this._setAttributeIfNotExists(target, 'aria-labelledby', `${child.id}`)\r\n    }\r\n  }\r\n\r\n  _toggleDropDown(element, open) {\r\n    const outerElem = this._getOuterElement(element)\r\n    if (!outerElem.classList.contains(CLASS_DROPDOWN)) {\r\n      return\r\n    }\r\n\r\n    const toggle = (selector, className) => {\r\n      const element = SelectorEngine.findOne(selector, outerElem)\r\n      if (element) {\r\n        element.classList.toggle(className, open)\r\n      }\r\n    }\r\n\r\n    toggle(SELECTOR_DROPDOWN_TOGGLE, CLASS_NAME_ACTIVE)\r\n    toggle(SELECTOR_DROPDOWN_MENU, CLASS_NAME_SHOW)\r\n    outerElem.setAttribute('aria-expanded', open)\r\n  }\r\n\r\n  _setAttributeIfNotExists(element, attribute, value) {\r\n    if (!element.hasAttribute(attribute)) {\r\n      element.setAttribute(attribute, value)\r\n    }\r\n  }\r\n\r\n  _elemIsActive(elem) {\r\n    return elem.classList.contains(CLASS_NAME_ACTIVE)\r\n  }\r\n\r\n  // Try to get the inner element (usually the .nav-link)\r\n  _getInnerElement(elem) {\r\n    return elem.matches(SELECTOR_INNER_ELEM) ? elem : SelectorEngine.findOne(SELECTOR_INNER_ELEM, elem)\r\n  }\r\n\r\n  // Try to get the outer element (usually the .nav-item)\r\n  _getOuterElement(elem) {\r\n    return elem.closest(SELECTOR_OUTER) || elem\r\n  }\r\n\r\n  // Static\r\n  static jQueryInterface(config) {\r\n    return this.each(function () {\r\n      const data = Tab.getOrCreateInstance(this)\r\n\r\n      if (typeof config !== 'string') {\r\n        return\r\n      }\r\n\r\n      if (data[config] === undefined || config.startsWith('_') || config === 'constructor') {\r\n        throw new TypeError(`No method named \"${config}\"`)\r\n      }\r\n\r\n      data[config]()\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Data API implementation\r\n */\r\n\r\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_DATA_TOGGLE, function (event) {\r\n  if (['A', 'AREA'].includes(this.tagName)) {\r\n    event.preventDefault()\r\n  }\r\n\r\n  if (isDisabled(this)) {\r\n    return\r\n  }\r\n\r\n  Tab.getOrCreateInstance(this).show()\r\n})\r\n\r\n/**\r\n * Initialize on focus\r\n */\r\nEventHandler.on(window, EVENT_LOAD_DATA_API, () => {\r\n  for (const element of SelectorEngine.find(SELECTOR_DATA_TOGGLE_ACTIVE)) {\r\n    Tab.getOrCreateInstance(element)\r\n  }\r\n})\r\n/**\r\n * jQuery\r\n */\r\n\r\ndefineJQueryPlugin(Tab)\r\n\r\nexport default Tab\r\n"],"names":["EVENT_KEY","EVENT_HIDE","EVENT_HIDDEN","EVENT_SHOW","EVENT_SHOWN","EVENT_CLICK_DATA_API","EVENT_KEYDOWN","EVENT_LOAD_DATA_API","ARROW_LEFT_KEY","ARROW_RIGHT_KEY","ARROW_UP_KEY","ARROW_DOWN_KEY","HOME_KEY","END_KEY","NOT_SELECTOR_DROPDOWN_TOGGLE","SELECTOR_INNER","SELECTOR_DATA_TOGGLE","SELECTOR_INNER_ELEM","SELECTOR_DATA_TOGGLE_ACTIVE","Tab","BaseComponent","constructor","element","_parent","this","_element","closest","_setInitialAttributes","_getChildren","on","event","_keydown","NAME","show","innerElem","_elemIsActive","active","_getActiveElem","hideEvent","EventHandler","trigger","relatedTarget","defaultPrevented","_deactivate","_activate","relatedElem","classList","add","SelectorEngine","getElementFromSelector","_queueCallback","getAttribute","removeAttribute","setAttribute","_toggleDropDown","contains","remove","blur","includes","key","stopPropagation","preventDefault","children","filter","nextActiveElement","length","isNext","target","focus","preventScroll","getOrCreateInstance","find","child","parent","_setAttributeIfNotExists","_setInitialAttributesOnChild","_getInnerElement","isActive","outerElem","_getOuterElement","_setInitialAttributesOnTargetPanel","id","open","toggle","selector","className","findOne","attribute","value","hasAttribute","elem","matches","config","each","data","undefined","startsWith","TypeError","document","tagName","window"],"mappings":"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"}