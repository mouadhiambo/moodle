{"version":3,"file":"collapse.min.js","sources":["../../src/bootstrap/collapse.js"],"sourcesContent":["/**\r\n * --------------------------------------------------------------------------\r\n * Bootstrap collapse.js\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\r\n * --------------------------------------------------------------------------\r\n */\r\n\r\nimport BaseComponent from './base-component'\r\nimport EventHandler from './dom/event-handler'\r\nimport SelectorEngine from './dom/selector-engine'\r\nimport {\r\n  defineJQueryPlugin,\r\n  getElement,\r\n  reflow\r\n} from './util/index'\r\n\r\n/**\r\n * Constants\r\n */\r\n\r\nconst NAME = 'collapse'\r\nconst DATA_KEY = 'bs.collapse'\r\nconst EVENT_KEY = `.${DATA_KEY}`\r\nconst DATA_API_KEY = '.data-api'\r\n\r\nconst EVENT_SHOW = `show${EVENT_KEY}`\r\nconst EVENT_SHOWN = `shown${EVENT_KEY}`\r\nconst EVENT_HIDE = `hide${EVENT_KEY}`\r\nconst EVENT_HIDDEN = `hidden${EVENT_KEY}`\r\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\r\n\r\nconst CLASS_NAME_SHOW = 'show'\r\nconst CLASS_NAME_COLLAPSE = 'collapse'\r\nconst CLASS_NAME_COLLAPSING = 'collapsing'\r\nconst CLASS_NAME_COLLAPSED = 'collapsed'\r\nconst CLASS_NAME_DEEPER_CHILDREN = `:scope .${CLASS_NAME_COLLAPSE} .${CLASS_NAME_COLLAPSE}`\r\nconst CLASS_NAME_HORIZONTAL = 'collapse-horizontal'\r\n\r\nconst WIDTH = 'width'\r\nconst HEIGHT = 'height'\r\n\r\nconst SELECTOR_ACTIVES = '.collapse.show, .collapse.collapsing'\r\nconst SELECTOR_DATA_TOGGLE = '[data-bs-toggle=\"collapse\"]'\r\n\r\nconst Default = {\r\n  parent: null,\r\n  toggle: true\r\n}\r\n\r\nconst DefaultType = {\r\n  parent: '(null|element)',\r\n  toggle: 'boolean'\r\n}\r\n\r\n/**\r\n * Class definition\r\n */\r\n\r\nclass Collapse extends BaseComponent {\r\n  constructor(element, config) {\r\n    super(element, config)\r\n\r\n    this._isTransitioning = false\r\n    this._triggerArray = []\r\n\r\n    const toggleList = SelectorEngine.find(SELECTOR_DATA_TOGGLE)\r\n\r\n    for (const elem of toggleList) {\r\n      const selector = SelectorEngine.getSelectorFromElement(elem)\r\n      const filterElement = SelectorEngine.find(selector)\r\n        .filter(foundElement => foundElement === this._element)\r\n\r\n      if (selector !== null && filterElement.length) {\r\n        this._triggerArray.push(elem)\r\n      }\r\n    }\r\n\r\n    this._initializeChildren()\r\n\r\n    if (!this._config.parent) {\r\n      this._addAriaAndCollapsedClass(this._triggerArray, this._isShown())\r\n    }\r\n\r\n    if (this._config.toggle) {\r\n      this.toggle()\r\n    }\r\n  }\r\n\r\n  // Getters\r\n  static get Default() {\r\n    return Default\r\n  }\r\n\r\n  static get DefaultType() {\r\n    return DefaultType\r\n  }\r\n\r\n  static get NAME() {\r\n    return NAME\r\n  }\r\n\r\n  // Public\r\n  toggle() {\r\n    if (this._isShown()) {\r\n      this.hide()\r\n    } else {\r\n      this.show()\r\n    }\r\n  }\r\n\r\n  show() {\r\n    if (this._isTransitioning || this._isShown()) {\r\n      return\r\n    }\r\n\r\n    let activeChildren = []\r\n\r\n    // find active children\r\n    if (this._config.parent) {\r\n      activeChildren = this._getFirstLevelChildren(SELECTOR_ACTIVES)\r\n        .filter(element => element !== this._element)\r\n        .map(element => Collapse.getOrCreateInstance(element, { toggle: false }))\r\n    }\r\n\r\n    if (activeChildren.length && activeChildren[0]._isTransitioning) {\r\n      return\r\n    }\r\n\r\n    const startEvent = EventHandler.trigger(this._element, EVENT_SHOW)\r\n    if (startEvent.defaultPrevented) {\r\n      return\r\n    }\r\n\r\n    for (const activeInstance of activeChildren) {\r\n      activeInstance.hide()\r\n    }\r\n\r\n    const dimension = this._getDimension()\r\n\r\n    this._element.classList.remove(CLASS_NAME_COLLAPSE)\r\n    this._element.classList.add(CLASS_NAME_COLLAPSING)\r\n\r\n    this._element.style[dimension] = 0\r\n\r\n    this._addAriaAndCollapsedClass(this._triggerArray, true)\r\n    this._isTransitioning = true\r\n\r\n    const complete = () => {\r\n      this._isTransitioning = false\r\n\r\n      this._element.classList.remove(CLASS_NAME_COLLAPSING)\r\n      this._element.classList.add(CLASS_NAME_COLLAPSE, CLASS_NAME_SHOW)\r\n\r\n      this._element.style[dimension] = ''\r\n\r\n      EventHandler.trigger(this._element, EVENT_SHOWN)\r\n    }\r\n\r\n    const capitalizedDimension = dimension[0].toUpperCase() + dimension.slice(1)\r\n    const scrollSize = `scroll${capitalizedDimension}`\r\n\r\n    this._queueCallback(complete, this._element, true)\r\n    this._element.style[dimension] = `${this._element[scrollSize]}px`\r\n  }\r\n\r\n  hide() {\r\n    if (this._isTransitioning || !this._isShown()) {\r\n      return\r\n    }\r\n\r\n    const startEvent = EventHandler.trigger(this._element, EVENT_HIDE)\r\n    if (startEvent.defaultPrevented) {\r\n      return\r\n    }\r\n\r\n    const dimension = this._getDimension()\r\n\r\n    this._element.style[dimension] = `${this._element.getBoundingClientRect()[dimension]}px`\r\n\r\n    reflow(this._element)\r\n\r\n    this._element.classList.add(CLASS_NAME_COLLAPSING)\r\n    this._element.classList.remove(CLASS_NAME_COLLAPSE, CLASS_NAME_SHOW)\r\n\r\n    for (const trigger of this._triggerArray) {\r\n      const element = SelectorEngine.getElementFromSelector(trigger)\r\n\r\n      if (element && !this._isShown(element)) {\r\n        this._addAriaAndCollapsedClass([trigger], false)\r\n      }\r\n    }\r\n\r\n    this._isTransitioning = true\r\n\r\n    const complete = () => {\r\n      this._isTransitioning = false\r\n      this._element.classList.remove(CLASS_NAME_COLLAPSING)\r\n      this._element.classList.add(CLASS_NAME_COLLAPSE)\r\n      EventHandler.trigger(this._element, EVENT_HIDDEN)\r\n    }\r\n\r\n    this._element.style[dimension] = ''\r\n\r\n    this._queueCallback(complete, this._element, true)\r\n  }\r\n\r\n  _isShown(element = this._element) {\r\n    return element.classList.contains(CLASS_NAME_SHOW)\r\n  }\r\n\r\n  // Private\r\n  _configAfterMerge(config) {\r\n    config.toggle = Boolean(config.toggle) // Coerce string values\r\n    config.parent = getElement(config.parent)\r\n    return config\r\n  }\r\n\r\n  _getDimension() {\r\n    return this._element.classList.contains(CLASS_NAME_HORIZONTAL) ? WIDTH : HEIGHT\r\n  }\r\n\r\n  _initializeChildren() {\r\n    if (!this._config.parent) {\r\n      return\r\n    }\r\n\r\n    const children = this._getFirstLevelChildren(SELECTOR_DATA_TOGGLE)\r\n\r\n    for (const element of children) {\r\n      const selected = SelectorEngine.getElementFromSelector(element)\r\n\r\n      if (selected) {\r\n        this._addAriaAndCollapsedClass([element], this._isShown(selected))\r\n      }\r\n    }\r\n  }\r\n\r\n  _getFirstLevelChildren(selector) {\r\n    const children = SelectorEngine.find(CLASS_NAME_DEEPER_CHILDREN, this._config.parent)\r\n    // remove children if greater depth\r\n    return SelectorEngine.find(selector, this._config.parent).filter(element => !children.includes(element))\r\n  }\r\n\r\n  _addAriaAndCollapsedClass(triggerArray, isOpen) {\r\n    if (!triggerArray.length) {\r\n      return\r\n    }\r\n\r\n    for (const element of triggerArray) {\r\n      element.classList.toggle(CLASS_NAME_COLLAPSED, !isOpen)\r\n      element.setAttribute('aria-expanded', isOpen)\r\n    }\r\n  }\r\n\r\n  // Static\r\n  static jQueryInterface(config) {\r\n    const _config = {}\r\n    if (typeof config === 'string' && /show|hide/.test(config)) {\r\n      _config.toggle = false\r\n    }\r\n\r\n    return this.each(function () {\r\n      const data = Collapse.getOrCreateInstance(this, _config)\r\n\r\n      if (typeof config === 'string') {\r\n        if (typeof data[config] === 'undefined') {\r\n          throw new TypeError(`No method named \"${config}\"`)\r\n        }\r\n\r\n        data[config]()\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Data API implementation\r\n */\r\n\r\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_DATA_TOGGLE, function (event) {\r\n  // preventDefault only for <a> elements (which change the URL) not inside the collapsible element\r\n  if (event.target.tagName === 'A' || (event.delegateTarget && event.delegateTarget.tagName === 'A')) {\r\n    event.preventDefault()\r\n  }\r\n\r\n  for (const element of SelectorEngine.getMultipleElementsFromSelector(this)) {\r\n    Collapse.getOrCreateInstance(element, { toggle: false }).toggle()\r\n  }\r\n})\r\n\r\n/**\r\n * jQuery\r\n */\r\n\r\ndefineJQueryPlugin(Collapse)\r\n\r\nexport default Collapse\r\n"],"names":["EVENT_KEY","EVENT_SHOW","EVENT_SHOWN","EVENT_HIDE","EVENT_HIDDEN","EVENT_CLICK_DATA_API","CLASS_NAME_DEEPER_CHILDREN","Default","parent","toggle","DefaultType","Collapse","BaseComponent","constructor","element","config","_isTransitioning","_triggerArray","toggleList","SelectorEngine","find","elem","selector","getSelectorFromElement","filterElement","filter","foundElement","this","_element","length","push","_initializeChildren","_config","_addAriaAndCollapsedClass","_isShown","NAME","hide","show","activeChildren","_getFirstLevelChildren","map","getOrCreateInstance","EventHandler","trigger","defaultPrevented","activeInstance","dimension","_getDimension","classList","remove","add","style","capitalizedDimension","toUpperCase","slice","scrollSize","_queueCallback","getBoundingClientRect","getElementFromSelector","contains","_configAfterMerge","Boolean","children","selected","includes","triggerArray","isOpen","setAttribute","test","each","data","TypeError","on","document","event","target","tagName","delegateTarget","preventDefault","getMultipleElementsFromSelector"],"mappings":"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"}