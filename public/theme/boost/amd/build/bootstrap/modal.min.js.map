{"version":3,"file":"modal.min.js","sources":["../../src/bootstrap/modal.js"],"sourcesContent":["/**\r\n * --------------------------------------------------------------------------\r\n * Bootstrap modal.js\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\r\n * --------------------------------------------------------------------------\r\n */\r\n\r\nimport BaseComponent from './base-component'\r\nimport EventHandler from './dom/event-handler'\r\nimport SelectorEngine from './dom/selector-engine'\r\nimport Backdrop from './util/backdrop'\r\nimport { enableDismissTrigger } from './util/component-functions'\r\nimport FocusTrap from './util/focustrap'\r\nimport {\r\n  defineJQueryPlugin, isRTL, isVisible, reflow\r\n} from './util/index'\r\nimport ScrollBarHelper from './util/scrollbar'\r\n\r\n/**\r\n * Constants\r\n */\r\n\r\nconst NAME = 'modal'\r\nconst DATA_KEY = 'bs.modal'\r\nconst EVENT_KEY = `.${DATA_KEY}`\r\nconst DATA_API_KEY = '.data-api'\r\nconst ESCAPE_KEY = 'Escape'\r\n\r\nconst EVENT_HIDE = `hide${EVENT_KEY}`\r\nconst EVENT_HIDE_PREVENTED = `hidePrevented${EVENT_KEY}`\r\nconst EVENT_HIDDEN = `hidden${EVENT_KEY}`\r\nconst EVENT_SHOW = `show${EVENT_KEY}`\r\nconst EVENT_SHOWN = `shown${EVENT_KEY}`\r\nconst EVENT_RESIZE = `resize${EVENT_KEY}`\r\nconst EVENT_CLICK_DISMISS = `click.dismiss${EVENT_KEY}`\r\nconst EVENT_MOUSEDOWN_DISMISS = `mousedown.dismiss${EVENT_KEY}`\r\nconst EVENT_KEYDOWN_DISMISS = `keydown.dismiss${EVENT_KEY}`\r\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\r\n\r\nconst CLASS_NAME_OPEN = 'modal-open'\r\nconst CLASS_NAME_FADE = 'fade'\r\nconst CLASS_NAME_SHOW = 'show'\r\nconst CLASS_NAME_STATIC = 'modal-static'\r\n\r\nconst OPEN_SELECTOR = '.modal.show'\r\nconst SELECTOR_DIALOG = '.modal-dialog'\r\nconst SELECTOR_MODAL_BODY = '.modal-body'\r\nconst SELECTOR_DATA_TOGGLE = '[data-bs-toggle=\"modal\"]'\r\n\r\nconst Default = {\r\n  backdrop: true,\r\n  focus: true,\r\n  keyboard: true\r\n}\r\n\r\nconst DefaultType = {\r\n  backdrop: '(boolean|string)',\r\n  focus: 'boolean',\r\n  keyboard: 'boolean'\r\n}\r\n\r\n/**\r\n * Class definition\r\n */\r\n\r\nclass Modal extends BaseComponent {\r\n  constructor(element, config) {\r\n    super(element, config)\r\n\r\n    this._dialog = SelectorEngine.findOne(SELECTOR_DIALOG, this._element)\r\n    this._backdrop = this._initializeBackDrop()\r\n    this._focustrap = this._initializeFocusTrap()\r\n    this._isShown = false\r\n    this._isTransitioning = false\r\n    this._scrollBar = new ScrollBarHelper()\r\n\r\n    this._addEventListeners()\r\n  }\r\n\r\n  // Getters\r\n  static get Default() {\r\n    return Default\r\n  }\r\n\r\n  static get DefaultType() {\r\n    return DefaultType\r\n  }\r\n\r\n  static get NAME() {\r\n    return NAME\r\n  }\r\n\r\n  // Public\r\n  toggle(relatedTarget) {\r\n    return this._isShown ? this.hide() : this.show(relatedTarget)\r\n  }\r\n\r\n  show(relatedTarget) {\r\n    if (this._isShown || this._isTransitioning) {\r\n      return\r\n    }\r\n\r\n    const showEvent = EventHandler.trigger(this._element, EVENT_SHOW, {\r\n      relatedTarget\r\n    })\r\n\r\n    if (showEvent.defaultPrevented) {\r\n      return\r\n    }\r\n\r\n    this._isShown = true\r\n    this._isTransitioning = true\r\n\r\n    this._scrollBar.hide()\r\n\r\n    document.body.classList.add(CLASS_NAME_OPEN)\r\n\r\n    this._adjustDialog()\r\n\r\n    this._backdrop.show(() => this._showElement(relatedTarget))\r\n  }\r\n\r\n  hide() {\r\n    if (!this._isShown || this._isTransitioning) {\r\n      return\r\n    }\r\n\r\n    const hideEvent = EventHandler.trigger(this._element, EVENT_HIDE)\r\n\r\n    if (hideEvent.defaultPrevented) {\r\n      return\r\n    }\r\n\r\n    this._isShown = false\r\n    this._isTransitioning = true\r\n    this._focustrap.deactivate()\r\n\r\n    this._element.classList.remove(CLASS_NAME_SHOW)\r\n\r\n    this._queueCallback(() => this._hideModal(), this._element, this._isAnimated())\r\n  }\r\n\r\n  dispose() {\r\n    EventHandler.off(window, EVENT_KEY)\r\n    EventHandler.off(this._dialog, EVENT_KEY)\r\n\r\n    this._backdrop.dispose()\r\n    this._focustrap.deactivate()\r\n\r\n    super.dispose()\r\n  }\r\n\r\n  handleUpdate() {\r\n    this._adjustDialog()\r\n  }\r\n\r\n  // Private\r\n  _initializeBackDrop() {\r\n    return new Backdrop({\r\n      isVisible: Boolean(this._config.backdrop), // 'static' option will be translated to true, and booleans will keep their value,\r\n      isAnimated: this._isAnimated()\r\n    })\r\n  }\r\n\r\n  _initializeFocusTrap() {\r\n    return new FocusTrap({\r\n      trapElement: this._element\r\n    })\r\n  }\r\n\r\n  _showElement(relatedTarget) {\r\n    // try to append dynamic modal\r\n    if (!document.body.contains(this._element)) {\r\n      document.body.append(this._element)\r\n    }\r\n\r\n    this._element.style.display = 'block'\r\n    this._element.removeAttribute('aria-hidden')\r\n    this._element.setAttribute('aria-modal', true)\r\n    this._element.setAttribute('role', 'dialog')\r\n    this._element.scrollTop = 0\r\n\r\n    const modalBody = SelectorEngine.findOne(SELECTOR_MODAL_BODY, this._dialog)\r\n    if (modalBody) {\r\n      modalBody.scrollTop = 0\r\n    }\r\n\r\n    reflow(this._element)\r\n\r\n    this._element.classList.add(CLASS_NAME_SHOW)\r\n\r\n    const transitionComplete = () => {\r\n      if (this._config.focus) {\r\n        this._focustrap.activate()\r\n      }\r\n\r\n      this._isTransitioning = false\r\n      EventHandler.trigger(this._element, EVENT_SHOWN, {\r\n        relatedTarget\r\n      })\r\n    }\r\n\r\n    this._queueCallback(transitionComplete, this._dialog, this._isAnimated())\r\n  }\r\n\r\n  _addEventListeners() {\r\n    EventHandler.on(this._element, EVENT_KEYDOWN_DISMISS, event => {\r\n      if (event.key !== ESCAPE_KEY) {\r\n        return\r\n      }\r\n\r\n      if (this._config.keyboard) {\r\n        this.hide()\r\n        return\r\n      }\r\n\r\n      this._triggerBackdropTransition()\r\n    })\r\n\r\n    EventHandler.on(window, EVENT_RESIZE, () => {\r\n      if (this._isShown && !this._isTransitioning) {\r\n        this._adjustDialog()\r\n      }\r\n    })\r\n\r\n    EventHandler.on(this._element, EVENT_MOUSEDOWN_DISMISS, event => {\r\n      // a bad trick to segregate clicks that may start inside dialog but end outside, and avoid listen to scrollbar clicks\r\n      EventHandler.one(this._element, EVENT_CLICK_DISMISS, event2 => {\r\n        if (this._element !== event.target || this._element !== event2.target) {\r\n          return\r\n        }\r\n\r\n        if (this._config.backdrop === 'static') {\r\n          this._triggerBackdropTransition()\r\n          return\r\n        }\r\n\r\n        if (this._config.backdrop) {\r\n          this.hide()\r\n        }\r\n      })\r\n    })\r\n  }\r\n\r\n  _hideModal() {\r\n    this._element.style.display = 'none'\r\n    this._element.setAttribute('aria-hidden', true)\r\n    this._element.removeAttribute('aria-modal')\r\n    this._element.removeAttribute('role')\r\n    this._isTransitioning = false\r\n\r\n    this._backdrop.hide(() => {\r\n      document.body.classList.remove(CLASS_NAME_OPEN)\r\n      this._resetAdjustments()\r\n      this._scrollBar.reset()\r\n      EventHandler.trigger(this._element, EVENT_HIDDEN)\r\n    })\r\n  }\r\n\r\n  _isAnimated() {\r\n    return this._element.classList.contains(CLASS_NAME_FADE)\r\n  }\r\n\r\n  _triggerBackdropTransition() {\r\n    const hideEvent = EventHandler.trigger(this._element, EVENT_HIDE_PREVENTED)\r\n    if (hideEvent.defaultPrevented) {\r\n      return\r\n    }\r\n\r\n    const isModalOverflowing = this._element.scrollHeight > document.documentElement.clientHeight\r\n    const initialOverflowY = this._element.style.overflowY\r\n    // return if the following background transition hasn't yet completed\r\n    if (initialOverflowY === 'hidden' || this._element.classList.contains(CLASS_NAME_STATIC)) {\r\n      return\r\n    }\r\n\r\n    if (!isModalOverflowing) {\r\n      this._element.style.overflowY = 'hidden'\r\n    }\r\n\r\n    this._element.classList.add(CLASS_NAME_STATIC)\r\n    this._queueCallback(() => {\r\n      this._element.classList.remove(CLASS_NAME_STATIC)\r\n      this._queueCallback(() => {\r\n        this._element.style.overflowY = initialOverflowY\r\n      }, this._dialog)\r\n    }, this._dialog)\r\n\r\n    this._element.focus()\r\n  }\r\n\r\n  /**\r\n   * The following methods are used to handle overflowing modals\r\n   */\r\n\r\n  _adjustDialog() {\r\n    const isModalOverflowing = this._element.scrollHeight > document.documentElement.clientHeight\r\n    const scrollbarWidth = this._scrollBar.getWidth()\r\n    const isBodyOverflowing = scrollbarWidth > 0\r\n\r\n    if (isBodyOverflowing && !isModalOverflowing) {\r\n      const property = isRTL() ? 'paddingLeft' : 'paddingRight'\r\n      this._element.style[property] = `${scrollbarWidth}px`\r\n    }\r\n\r\n    if (!isBodyOverflowing && isModalOverflowing) {\r\n      const property = isRTL() ? 'paddingRight' : 'paddingLeft'\r\n      this._element.style[property] = `${scrollbarWidth}px`\r\n    }\r\n  }\r\n\r\n  _resetAdjustments() {\r\n    this._element.style.paddingLeft = ''\r\n    this._element.style.paddingRight = ''\r\n  }\r\n\r\n  // Static\r\n  static jQueryInterface(config, relatedTarget) {\r\n    return this.each(function () {\r\n      const data = Modal.getOrCreateInstance(this, config)\r\n\r\n      if (typeof config !== 'string') {\r\n        return\r\n      }\r\n\r\n      if (typeof data[config] === 'undefined') {\r\n        throw new TypeError(`No method named \"${config}\"`)\r\n      }\r\n\r\n      data[config](relatedTarget)\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Data API implementation\r\n */\r\n\r\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_DATA_TOGGLE, function (event) {\r\n  const target = SelectorEngine.getElementFromSelector(this)\r\n\r\n  if (['A', 'AREA'].includes(this.tagName)) {\r\n    event.preventDefault()\r\n  }\r\n\r\n  EventHandler.one(target, EVENT_SHOW, showEvent => {\r\n    if (showEvent.defaultPrevented) {\r\n      // only register focus restorer if modal will actually get shown\r\n      return\r\n    }\r\n\r\n    EventHandler.one(target, EVENT_HIDDEN, () => {\r\n      if (isVisible(this)) {\r\n        this.focus()\r\n      }\r\n    })\r\n  })\r\n\r\n  // avoid conflict when clicking modal toggler while another one is open\r\n  const alreadyOpen = SelectorEngine.findOne(OPEN_SELECTOR)\r\n  if (alreadyOpen) {\r\n    Modal.getInstance(alreadyOpen).hide()\r\n  }\r\n\r\n  const data = Modal.getOrCreateInstance(target)\r\n\r\n  data.toggle(this)\r\n})\r\n\r\nenableDismissTrigger(Modal)\r\n\r\n/**\r\n * jQuery\r\n */\r\n\r\ndefineJQueryPlugin(Modal)\r\n\r\nexport default Modal\r\n"],"names":["EVENT_KEY","EVENT_HIDE","EVENT_HIDE_PREVENTED","EVENT_HIDDEN","EVENT_SHOW","EVENT_SHOWN","EVENT_RESIZE","EVENT_CLICK_DISMISS","EVENT_MOUSEDOWN_DISMISS","EVENT_KEYDOWN_DISMISS","EVENT_CLICK_DATA_API","Default","backdrop","focus","keyboard","DefaultType","Modal","BaseComponent","constructor","element","config","_dialog","SelectorEngine","findOne","this","_element","_backdrop","_initializeBackDrop","_focustrap","_initializeFocusTrap","_isShown","_isTransitioning","_scrollBar","ScrollBarHelper","_addEventListeners","NAME","toggle","relatedTarget","hide","show","EventHandler","trigger","defaultPrevented","document","body","classList","add","_adjustDialog","_showElement","deactivate","remove","_queueCallback","_hideModal","_isAnimated","dispose","off","window","handleUpdate","Backdrop","isVisible","Boolean","_config","isAnimated","FocusTrap","trapElement","contains","append","style","display","removeAttribute","setAttribute","scrollTop","modalBody","activate","on","event","key","_triggerBackdropTransition","one","event2","target","_resetAdjustments","reset","isModalOverflowing","scrollHeight","documentElement","clientHeight","initialOverflowY","overflowY","scrollbarWidth","getWidth","isBodyOverflowing","property","paddingLeft","paddingRight","each","data","getOrCreateInstance","TypeError","getElementFromSelector","includes","tagName","preventDefault","showEvent","alreadyOpen","getInstance"],"mappings":"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"}