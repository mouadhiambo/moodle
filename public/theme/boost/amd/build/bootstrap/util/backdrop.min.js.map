{"version":3,"file":"backdrop.min.js","sources":["../../../src/bootstrap/util/backdrop.js"],"sourcesContent":["/**\r\n * --------------------------------------------------------------------------\r\n * Bootstrap util/backdrop.js\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\r\n * --------------------------------------------------------------------------\r\n */\r\n\r\nimport EventHandler from '../dom/event-handler'\r\nimport Config from './config'\r\nimport {\r\n  execute, executeAfterTransition, getElement, reflow\r\n} from './index'\r\n\r\n/**\r\n * Constants\r\n */\r\n\r\nconst NAME = 'backdrop'\r\nconst CLASS_NAME_FADE = 'fade'\r\nconst CLASS_NAME_SHOW = 'show'\r\nconst EVENT_MOUSEDOWN = `mousedown.bs.${NAME}`\r\n\r\nconst Default = {\r\n  className: 'modal-backdrop',\r\n  clickCallback: null,\r\n  isAnimated: false,\r\n  isVisible: true, // if false, we use the backdrop helper without adding any element to the dom\r\n  rootElement: 'body' // give the choice to place backdrop under different elements\r\n}\r\n\r\nconst DefaultType = {\r\n  className: 'string',\r\n  clickCallback: '(function|null)',\r\n  isAnimated: 'boolean',\r\n  isVisible: 'boolean',\r\n  rootElement: '(element|string)'\r\n}\r\n\r\n/**\r\n * Class definition\r\n */\r\n\r\nclass Backdrop extends Config {\r\n  constructor(config) {\r\n    super()\r\n    this._config = this._getConfig(config)\r\n    this._isAppended = false\r\n    this._element = null\r\n  }\r\n\r\n  // Getters\r\n  static get Default() {\r\n    return Default\r\n  }\r\n\r\n  static get DefaultType() {\r\n    return DefaultType\r\n  }\r\n\r\n  static get NAME() {\r\n    return NAME\r\n  }\r\n\r\n  // Public\r\n  show(callback) {\r\n    if (!this._config.isVisible) {\r\n      execute(callback)\r\n      return\r\n    }\r\n\r\n    this._append()\r\n\r\n    const element = this._getElement()\r\n    if (this._config.isAnimated) {\r\n      reflow(element)\r\n    }\r\n\r\n    element.classList.add(CLASS_NAME_SHOW)\r\n\r\n    this._emulateAnimation(() => {\r\n      execute(callback)\r\n    })\r\n  }\r\n\r\n  hide(callback) {\r\n    if (!this._config.isVisible) {\r\n      execute(callback)\r\n      return\r\n    }\r\n\r\n    this._getElement().classList.remove(CLASS_NAME_SHOW)\r\n\r\n    this._emulateAnimation(() => {\r\n      this.dispose()\r\n      execute(callback)\r\n    })\r\n  }\r\n\r\n  dispose() {\r\n    if (!this._isAppended) {\r\n      return\r\n    }\r\n\r\n    EventHandler.off(this._element, EVENT_MOUSEDOWN)\r\n\r\n    this._element.remove()\r\n    this._isAppended = false\r\n  }\r\n\r\n  // Private\r\n  _getElement() {\r\n    if (!this._element) {\r\n      const backdrop = document.createElement('div')\r\n      backdrop.className = this._config.className\r\n      if (this._config.isAnimated) {\r\n        backdrop.classList.add(CLASS_NAME_FADE)\r\n      }\r\n\r\n      this._element = backdrop\r\n    }\r\n\r\n    return this._element\r\n  }\r\n\r\n  _configAfterMerge(config) {\r\n    // use getElement() with the default \"body\" to get a fresh Element on each instantiation\r\n    config.rootElement = getElement(config.rootElement)\r\n    return config\r\n  }\r\n\r\n  _append() {\r\n    if (this._isAppended) {\r\n      return\r\n    }\r\n\r\n    const element = this._getElement()\r\n    this._config.rootElement.append(element)\r\n\r\n    EventHandler.on(element, EVENT_MOUSEDOWN, () => {\r\n      execute(this._config.clickCallback)\r\n    })\r\n\r\n    this._isAppended = true\r\n  }\r\n\r\n  _emulateAnimation(callback) {\r\n    executeAfterTransition(callback, this._getElement(), this._config.isAnimated)\r\n  }\r\n}\r\n\r\nexport default Backdrop\r\n"],"names":["EVENT_MOUSEDOWN","Default","className","clickCallback","isAnimated","isVisible","rootElement","DefaultType","Backdrop","Config","constructor","config","_config","this","_getConfig","_isAppended","_element","NAME","show","callback","_append","element","_getElement","classList","add","_emulateAnimation","hide","remove","dispose","off","backdrop","document","createElement","_configAfterMerge","append","on"],"mappings":"0ZAoBMA,uCAHO,YAKPC,QAAU,CACdC,UAAW,iBACXC,cAAe,KACfC,YAAY,EACZC,WAAW,EACXC,YAAa,QAGTC,YAAc,CAClBL,UAAW,SACXC,cAAe,kBACfC,WAAY,UACZC,UAAW,UACXC,YAAa,0BAOTE,iBAAiBC,gBACrBC,YAAYC,qBAELC,QAAUC,KAAKC,WAAWH,aAC1BI,aAAc,OACdC,SAAW,KAIPf,4BACFA,QAGEM,gCACFA,YAGEU,wBA1CA,WA+CXC,KAAKC,cACEN,KAAKD,QAAQP,wCACRc,eAILC,gBAECC,QAAUR,KAAKS,cACjBT,KAAKD,QAAQR,8BACRiB,SAGTA,QAAQE,UAAUC,IA1DE,aA4DfC,mBAAkB,wBACbN,aAIZO,KAAKP,UACEN,KAAKD,QAAQP,gBAKbiB,cAAcC,UAAUI,OAvET,aAyEfF,mBAAkB,UAChBG,6BACGT,iCARAA,UAYZS,UACOf,KAAKE,oCAIGc,IAAIhB,KAAKG,SAAUhB,sBAE3BgB,SAASW,cACTZ,aAAc,GAIrBO,kBACOT,KAAKG,SAAU,OACZc,SAAWC,SAASC,cAAc,OACxCF,SAAS5B,UAAYW,KAAKD,QAAQV,UAC9BW,KAAKD,QAAQR,YACf0B,SAASP,UAAUC,IAjGH,aAoGbR,SAAWc,gBAGXjB,KAAKG,SAGdiB,kBAAkBtB,eAEhBA,OAAOL,aAAc,qBAAWK,OAAOL,aAChCK,OAGTS,aACMP,KAAKE,yBAIHM,QAAUR,KAAKS,mBAChBV,QAAQN,YAAY4B,OAAOb,+BAEnBc,GAAGd,QAASrB,iBAAiB,wBAChCa,KAAKD,QAAQT,uBAGlBY,aAAc,EAGrBU,kBAAkBN,4CACOA,SAAUN,KAAKS,cAAeT,KAAKD,QAAQR,0BAIvDI"}