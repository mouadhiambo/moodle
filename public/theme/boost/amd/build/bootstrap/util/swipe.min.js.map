{"version":3,"file":"swipe.min.js","sources":["../../../src/bootstrap/util/swipe.js"],"sourcesContent":["/**\r\n * --------------------------------------------------------------------------\r\n * Bootstrap util/swipe.js\r\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\r\n * --------------------------------------------------------------------------\r\n */\r\n\r\nimport EventHandler from '../dom/event-handler'\r\nimport Config from './config'\r\nimport { execute } from './index'\r\n\r\n/**\r\n * Constants\r\n */\r\n\r\nconst NAME = 'swipe'\r\nconst EVENT_KEY = '.bs.swipe'\r\nconst EVENT_TOUCHSTART = `touchstart${EVENT_KEY}`\r\nconst EVENT_TOUCHMOVE = `touchmove${EVENT_KEY}`\r\nconst EVENT_TOUCHEND = `touchend${EVENT_KEY}`\r\nconst EVENT_POINTERDOWN = `pointerdown${EVENT_KEY}`\r\nconst EVENT_POINTERUP = `pointerup${EVENT_KEY}`\r\nconst POINTER_TYPE_TOUCH = 'touch'\r\nconst POINTER_TYPE_PEN = 'pen'\r\nconst CLASS_NAME_POINTER_EVENT = 'pointer-event'\r\nconst SWIPE_THRESHOLD = 40\r\n\r\nconst Default = {\r\n  endCallback: null,\r\n  leftCallback: null,\r\n  rightCallback: null\r\n}\r\n\r\nconst DefaultType = {\r\n  endCallback: '(function|null)',\r\n  leftCallback: '(function|null)',\r\n  rightCallback: '(function|null)'\r\n}\r\n\r\n/**\r\n * Class definition\r\n */\r\n\r\nclass Swipe extends Config {\r\n  constructor(element, config) {\r\n    super()\r\n    this._element = element\r\n\r\n    if (!element || !Swipe.isSupported()) {\r\n      return\r\n    }\r\n\r\n    this._config = this._getConfig(config)\r\n    this._deltaX = 0\r\n    this._supportPointerEvents = Boolean(window.PointerEvent)\r\n    this._initEvents()\r\n  }\r\n\r\n  // Getters\r\n  static get Default() {\r\n    return Default\r\n  }\r\n\r\n  static get DefaultType() {\r\n    return DefaultType\r\n  }\r\n\r\n  static get NAME() {\r\n    return NAME\r\n  }\r\n\r\n  // Public\r\n  dispose() {\r\n    EventHandler.off(this._element, EVENT_KEY)\r\n  }\r\n\r\n  // Private\r\n  _start(event) {\r\n    if (!this._supportPointerEvents) {\r\n      this._deltaX = event.touches[0].clientX\r\n\r\n      return\r\n    }\r\n\r\n    if (this._eventIsPointerPenTouch(event)) {\r\n      this._deltaX = event.clientX\r\n    }\r\n  }\r\n\r\n  _end(event) {\r\n    if (this._eventIsPointerPenTouch(event)) {\r\n      this._deltaX = event.clientX - this._deltaX\r\n    }\r\n\r\n    this._handleSwipe()\r\n    execute(this._config.endCallback)\r\n  }\r\n\r\n  _move(event) {\r\n    this._deltaX = event.touches && event.touches.length > 1 ?\r\n      0 :\r\n      event.touches[0].clientX - this._deltaX\r\n  }\r\n\r\n  _handleSwipe() {\r\n    const absDeltaX = Math.abs(this._deltaX)\r\n\r\n    if (absDeltaX <= SWIPE_THRESHOLD) {\r\n      return\r\n    }\r\n\r\n    const direction = absDeltaX / this._deltaX\r\n\r\n    this._deltaX = 0\r\n\r\n    if (!direction) {\r\n      return\r\n    }\r\n\r\n    execute(direction > 0 ? this._config.rightCallback : this._config.leftCallback)\r\n  }\r\n\r\n  _initEvents() {\r\n    if (this._supportPointerEvents) {\r\n      EventHandler.on(this._element, EVENT_POINTERDOWN, event => this._start(event))\r\n      EventHandler.on(this._element, EVENT_POINTERUP, event => this._end(event))\r\n\r\n      this._element.classList.add(CLASS_NAME_POINTER_EVENT)\r\n    } else {\r\n      EventHandler.on(this._element, EVENT_TOUCHSTART, event => this._start(event))\r\n      EventHandler.on(this._element, EVENT_TOUCHMOVE, event => this._move(event))\r\n      EventHandler.on(this._element, EVENT_TOUCHEND, event => this._end(event))\r\n    }\r\n  }\r\n\r\n  _eventIsPointerPenTouch(event) {\r\n    return this._supportPointerEvents && (event.pointerType === POINTER_TYPE_PEN || event.pointerType === POINTER_TYPE_TOUCH)\r\n  }\r\n\r\n  // Static\r\n  static isSupported() {\r\n    return 'ontouchstart' in document.documentElement || navigator.maxTouchPoints > 0\r\n  }\r\n}\r\n\r\nexport default Swipe\r\n"],"names":["EVENT_TOUCHSTART","EVENT_TOUCHMOVE","EVENT_TOUCHEND","EVENT_POINTERDOWN","EVENT_POINTERUP","Default","endCallback","leftCallback","rightCallback","DefaultType","Swipe","Config","constructor","element","config","_element","isSupported","_config","this","_getConfig","_deltaX","_supportPointerEvents","Boolean","window","PointerEvent","_initEvents","NAME","dispose","off","_start","event","_eventIsPointerPenTouch","clientX","touches","_end","_handleSwipe","_move","length","absDeltaX","Math","abs","direction","on","classList","add","pointerType","document","documentElement","navigator","maxTouchPoints"],"mappings":"uZAiBMA,qCADY,aAEZC,mCAFY,aAGZC,iCAHY,aAIZC,uCAJY,aAKZC,mCALY,aAWZC,QAAU,CACdC,YAAa,KACbC,aAAc,KACdC,cAAe,MAGXC,YAAc,CAClBH,YAAa,kBACbC,aAAc,kBACdC,cAAe,yBAOXE,cAAcC,gBAClBC,YAAYC,QAASC,qBAEdC,SAAWF,QAEXA,SAAYH,MAAMM,qBAIlBC,QAAUC,KAAKC,WAAWL,aAC1BM,QAAU,OACVC,sBAAwBC,QAAQC,OAAOC,mBACvCC,eAIIpB,4BACFA,QAGEI,gCACFA,YAGEiB,wBApDA,QAyDXC,gCACeC,IAAIV,KAAKH,SAzDR,aA6DhBc,OAAOC,OACAZ,KAAKG,sBAMNH,KAAKa,wBAAwBD,cAC1BV,QAAUU,MAAME,cANhBZ,QAAUU,MAAMG,QAAQ,GAAGD,QAUpCE,KAAKJ,OACCZ,KAAKa,wBAAwBD,cAC1BV,QAAUU,MAAME,QAAUd,KAAKE,cAGjCe,kCACGjB,KAAKD,QAAQX,aAGvB8B,MAAMN,YACCV,QAAUU,MAAMG,SAAWH,MAAMG,QAAQI,OAAS,EACrD,EACAP,MAAMG,QAAQ,GAAGD,QAAUd,KAAKE,QAGpCe,qBACQG,UAAYC,KAAKC,IAAItB,KAAKE,YAE5BkB,WAlFgB,gBAsFdG,UAAYH,UAAYpB,KAAKE,aAE9BA,QAAU,EAEVqB,8BAIGA,UAAY,EAAIvB,KAAKD,QAAQT,cAAgBU,KAAKD,QAAQV,cAGpEkB,cACMP,KAAKG,6CACMqB,GAAGxB,KAAKH,SAAUZ,mBAAmB2B,OAASZ,KAAKW,OAAOC,+BAC1DY,GAAGxB,KAAKH,SAAUX,iBAAiB0B,OAASZ,KAAKgB,KAAKJ,cAE9Df,SAAS4B,UAAUC,IAvGG,yCAyGdF,GAAGxB,KAAKH,SAAUf,kBAAkB8B,OAASZ,KAAKW,OAAOC,+BACzDY,GAAGxB,KAAKH,SAAUd,iBAAiB6B,OAASZ,KAAKkB,MAAMN,+BACvDY,GAAGxB,KAAKH,SAAUb,gBAAgB4B,OAASZ,KAAKgB,KAAKJ,UAItEC,wBAAwBD,cACfZ,KAAKG,wBAjHS,QAiHiBS,MAAMe,aAlHrB,UAkHyDf,MAAMe,wCAK/E,iBAAkBC,SAASC,iBAAmBC,UAAUC,eAAiB,gBAIrEvC"}