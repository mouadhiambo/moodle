{"version":3,"file":"task_indicator.min.js","sources":["../src/task_indicator.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Task indicator\r\n *\r\n * Watches the progress bar inside the task indicator for updates, and redirects when the progress is complete.\r\n *\r\n * @module     core/task_indicator\r\n * @copyright  2024 Catalyst IT Europe Ltd\r\n * @author     Mark Johnson <mark.johnson@catalyst-eu.net>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\nexport default class {\r\n    /**\r\n     * Watch the progress bar for updates.\r\n     *\r\n     * When the progress bar is updated to 100%, wait a couple of seconds so the user gets to see it if they are watching,\r\n     * then redirect to the specified URL.\r\n     *\r\n     * @param {String} id The ID of the progress bar element.\r\n     * @param {String} redirectUrl Optional URL to redirect to once the task is complete.\r\n     */\r\n    static init(id, redirectUrl) {\r\n        const bar = document.getElementById(id);\r\n        bar.addEventListener('update', (event) => {\r\n            const percent = event?.detail?.percent;\r\n            if (percent > 0) {\r\n                // Once progress starts, display the progress bar and remove the run link.\r\n                bar.classList.remove('stored-progress-notstarted');\r\n                const runlink = document.querySelector(`.runlink[data-idnumber=${id}]`);\r\n                if (runlink) {\r\n                    runlink.remove();\r\n                }\r\n            }\r\n            // Once the progress bar completes, redirect the page.\r\n            if (redirectUrl !== '' && percent === 100) {\r\n                window.setTimeout(() => window.location.assign(redirectUrl), 2000);\r\n            }\r\n        });\r\n    }\r\n}\r\n"],"names":["id","redirectUrl","bar","document","getElementById","addEventListener","event","percent","detail","_event$detail","classList","remove","runlink","querySelector","window","setTimeout","location","assign"],"mappings":";;;;;;;;;;;kBAmCgBA,GAAIC,mBACNC,IAAMC,SAASC,eAAeJ,IACpCE,IAAIG,iBAAiB,UAAWC,gCACtBC,QAAUD,MAAAA,6BAAAA,MAAOE,uCAAPC,cAAeF,WAC3BA,QAAU,EAAG,CAEbL,IAAIQ,UAAUC,OAAO,oCACfC,QAAUT,SAASU,+CAAwCb,SAC7DY,SACAA,QAAQD,SAII,KAAhBV,aAAkC,MAAZM,SACtBO,OAAOC,YAAW,IAAMD,OAAOE,SAASC,OAAOhB,cAAc"}