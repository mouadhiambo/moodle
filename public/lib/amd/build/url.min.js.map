{"version":3,"file":"url.min.js","sources":["../src/url.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * URL utility functions.\r\n *\r\n * @module     core/url\r\n * @copyright  2015 Damyon Wiese <damyon@moodle.com>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n * @since      2.9\r\n */\r\ndefine(['jquery', 'core/config'], function($, config) {\r\n\r\n\r\n    return /** @alias module:core/url */ {\r\n        // Public variables and functions.\r\n        /**\r\n         * Construct a file url\r\n         *\r\n         * @method fileUrl\r\n         * @param {string} relativeScript\r\n         * @param {string} slashArg\r\n         * @return {string}\r\n         */\r\n        fileUrl: function(relativeScript, slashArg) {\r\n\r\n            var url = config.wwwroot + relativeScript;\r\n\r\n            // Force a /\r\n            if (slashArg.charAt(0) != '/') {\r\n                slashArg = '/' + slashArg;\r\n            }\r\n            if (config.slasharguments) {\r\n                url += slashArg;\r\n            } else {\r\n                url += '?file=' + encodeURIComponent(slashArg);\r\n            }\r\n            return url;\r\n        },\r\n\r\n        /**\r\n         * Take a path relative to the moodle basedir and do some fixing (see class moodle_url in php).\r\n         *\r\n         * @method relativeUrl\r\n         * @param {string} relativePath The path relative to the moodle basedir.\r\n         * @param {object} params The query parameters for the URL.\r\n         * @param {bool} includeSessKey Add the session key to the query params.\r\n         * @return {string}\r\n         */\r\n        relativeUrl: function(relativePath, params, includeSessKey) {\r\n\r\n            if (relativePath.indexOf('http:') === 0 || relativePath.indexOf('https:') === 0 || relativePath.indexOf('://') >= 0) {\r\n                throw new Error('relativeUrl function does not accept absolute urls');\r\n            }\r\n\r\n            // Fix non-relative paths;\r\n            if (relativePath.charAt(0) != '/') {\r\n                relativePath = '/' + relativePath;\r\n            }\r\n\r\n            // Fix admin urls.\r\n            if (config.admin !== 'admin') {\r\n                relativePath = relativePath.replace(/^\\/admin\\//, '/' + config.admin + '/');\r\n            }\r\n\r\n            params = params || {};\r\n            if (includeSessKey) {\r\n                params.sesskey = config.sesskey;\r\n            }\r\n\r\n            var queryString = '';\r\n            if (Object.keys(params).length) {\r\n                queryString = $.map(params, function(value, param) {\r\n                    return param + '=' + value;\r\n                }).join('&');\r\n            }\r\n\r\n            if (queryString !== '') {\r\n                return config.wwwroot + relativePath + '?' + queryString;\r\n            } else {\r\n                return config.wwwroot + relativePath;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Wrapper for image_url function.\r\n         *\r\n         * @method imageUrl\r\n         * @param {string} imagename The image name (e.g. t/edit).\r\n         * @param {string} component The component (e.g. mod_feedback).\r\n         * @return {string}\r\n         */\r\n        imageUrl: function(imagename, component) {\r\n            return M.util.image_url(imagename, component);\r\n        }\r\n    };\r\n});\r\n"],"names":["define","$","config","fileUrl","relativeScript","slashArg","url","wwwroot","charAt","slasharguments","encodeURIComponent","relativeUrl","relativePath","params","includeSessKey","indexOf","Error","admin","replace","sesskey","queryString","Object","keys","length","map","value","param","join","imageUrl","imagename","component","M","util","image_url"],"mappings":";;;;;;;;AAuBAA,kBAAO,CAAC,SAAU,gBAAgB,SAASC,EAAGC,cAGL,CAUjCC,QAAS,SAASC,eAAgBC,cAE1BC,IAAMJ,OAAOK,QAAUH,qBAGD,KAAtBC,SAASG,OAAO,KAChBH,SAAW,IAAMA,UAEjBH,OAAOO,eACPH,KAAOD,SAEPC,KAAO,SAAWI,mBAAmBL,UAElCC,KAYXK,YAAa,SAASC,aAAcC,OAAQC,mBAEF,IAAlCF,aAAaG,QAAQ,UAAqD,IAAnCH,aAAaG,QAAQ,WAAmBH,aAAaG,QAAQ,QAAU,QACxG,IAAIC,MAAM,sDAIU,KAA1BJ,aAAaJ,OAAO,KACpBI,aAAe,IAAMA,cAIJ,UAAjBV,OAAOe,QACPL,aAAeA,aAAaM,QAAQ,aAAc,IAAMhB,OAAOe,MAAQ,MAG3EJ,OAASA,QAAU,GACfC,iBACAD,OAAOM,QAAUjB,OAAOiB,aAGxBC,YAAc,UACdC,OAAOC,KAAKT,QAAQU,SACpBH,YAAcnB,EAAEuB,IAAIX,QAAQ,SAASY,MAAOC,cACjCA,MAAQ,IAAMD,SACtBE,KAAK,MAGQ,KAAhBP,YACOlB,OAAOK,QAAUK,aAAe,IAAMQ,YAEtClB,OAAOK,QAAUK,cAYhCgB,SAAU,SAASC,UAAWC,kBACnBC,EAAEC,KAAKC,UAAUJ,UAAWC"}